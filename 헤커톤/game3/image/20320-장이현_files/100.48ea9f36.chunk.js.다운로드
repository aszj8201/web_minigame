(this["webpackJsonppolaris-weboffice"]=this["webpackJsonppolaris-weboffice"]||[]).push([[100,130,153,154],{387:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return O}));var r=n(19),o=n(20),a=n(186),i=n(24),c=n(102),u=n(18),s=n(10),l=n(45),f=n(37),d=n(116),p=n(11),h=n(0),m=n(130),v=n(34),b=n(39),g=n(15),w=n(14),P=n(33),O=function(){function e(){Object(r.a)(this,e)}return Object(o.a)(e,[{key:"openDocument",value:function(e){var t="The document could not be opened.";return e?e.name?Object(d.b)(e.name)?e.blob?C(e.name,e.blob).catch((function(e){return u.b.api.rejectOpenDocument("".concat(t," [").concat(e.message,"]"),e.errorCode,e.closeDialog)})):u.b.api.reject(t,"[There is no 'blob' in the 'document'. Please set the 'blob' and try again.]"):u.b.api.reject(t,"[Please include an extension in the name.]"):u.b.api.reject(t,"[There is no 'name' in the 'document'. Please set the 'name' and try again.]"):u.b.api.reject(t,"[An argument for 'document' was not provided. Please set the 'document' and try again.]")}},{key:"getSDKInformation",value:function(){return y()}},{key:"movePage",value:function(e){k(e)}},{key:"isReadOnlyDocument",value:function(){return T()}}]),e}(),C=function(e,t){return new Promise((function(n,r){var o,a=Object(d.b)(e);if(I(a)){c.a.setListener("onOpenComplete",(function(){Object(s.c)(Object(f.c)(e)),Object(s.c)(Object(f.e)(a)),n(),o=null,c.a.removeListener("onOpenComplete")})),c.a.setListener("onLoadFail",(function(t){Object(s.c)(Object(f.c)(e)),Object(s.c)(Object(f.e)(a)),r({message:"Loading failed '".concat(e,"'."),errorCode:t,closeDialog:new Promise((function(e){c.a.setListener("onCancelOpenDocument",(function(){e(),c.a.removeListener("onCancelOpenDocument")}))}))}),o=null,c.a.removeListener("onLoadFail")})),c.a.setListener("onLoadForce",(function(){null!==o&&i(o,!0),o=null,c.a.removeListener("onLoadForce")}));var i=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"hwpx"===a?m.a.setOpenMode(h.EPROTECT_READ_MODE.ePRM_READ_ONLY_RECOMMENDED_READONLY):m.a.setOpenMode(h.EPROTECT_READ_MODE.ePRM_COMMON),m.a.setDocData(t,a);var r=Object(s.d)(l.d);Object(w.o)()?p.a.memoryOpenForViewerSDK(".".concat(a),e,e.byteLength,r.width,r.height):p.a.memoryOpen(".".concat(a),e,e.byteLength,r.width,r.height,n),Object(s.c)(Object(P.j)(!1))},u=new FileReader;u.onload=function(){u.readyState===FileReader.DONE&&u.result instanceof ArrayBuffer&&(o=u.result,i(u.result))};var g=function(e){r({message:e,errorCode:-1,closeDialog:new Promise((function(e){c.a.setListener("onCancelOpenDocument",(function(){e(),c.a.removeListener("onCancelOpenDocument")}))}))})};u.onabort=function(){g("Reading the file is aborted. '".concat(u.error,"'."))},u.onerror=function(){g("Failed to read file. '".concat(u.error,"'."))},u.readAsArrayBuffer(t)}else v.a.showDialog({dialogId:b.a.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_NOTSUPPORT",values:{arg1:"(.".concat(a,")")}},currentTabIndex:0},(function(){r({message:"This document format is not supported. '(.".concat(a,")'"),closeDialog:new Promise((function(e){c.a.setListener("onCancelOpenDocument",(function(){e(),c.a.removeListener("onCancelOpenDocument")}))}))})}))}))},y=function(){return{version:i.c,formats:i.b,licenseKey:a.a}},I=function(e){var t=Object(s.d)(f.b).docType,n=e.toLowerCase();if(t===g.b.hwp){if(["hwp","hwpx"].includes(n))return!0}else if(t===g.b.word){if(["doc","docx"].includes(n))return!0}else if(t===g.b.sheet){if(["xls","xlsx","csv"].includes(n))return!0}else if(t===g.b.slide&&["ppt","pptx"].includes(n))return!0;return!1},k=function(e){var t=e,n=p.a.getConfig().nTotalPages;t<1&&(t=1),t>n&&(t=n),p.a.movePage(h.BrMovePageType.eEV_MOVE_SETPAGE,t)},T=function(){return m.a.isProtectDoc()||m.a.isReadOnlyDoc()}},388:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g}));var r=n(19),o=n(20),a=n(102),i=n(18),c=n(10),u=n(45),s=n(37),l=n(11),f=n(0),d=n(33),p=n(55),h=n(34),m=n(39),v=n(24),b=n(130),g=function(){function e(){Object(r.a)(this,e)}return Object(o.a)(e,[{key:"saveDocument",value:function(){return w().catch((function(e){return i.b.api.reject("The document could not be saved.","[".concat(e.message,"]"))}))}},{key:"isModified",value:function(){return P()}},{key:"getDocContentRect",value:function(){return O()}},{key:"getTitleBarRect",value:function(){return C()}},{key:"getRibbonTabMenuRect",value:function(){return y()}},{key:"getRibbonBarRect",value:function(){return I()}},{key:"getViewMode",value:function(){return k()}},{key:"activeInput",value:function(){T()}},{key:"isProtectedDocument",value:function(){return b.a.isPasswordDocument}},{key:"insertImage",value:function(e,t){}}]),e}(),w=function(){return new Promise((function(e,t){var n=Object(c.d)(s.b),r=n.extension,o=n.docName;if(a.a.setListener("onSaveDocument",(function(n,i){if(n===f.ResultOnSaveDocument.kPoProcessSucess&&i)if("hwpx"===r){var c="".concat(o.replace(new RegExp(".".concat(r,"$")),".hwp"));e({name:c,blob:i})}else e({name:o,blob:i});else t(new Error("Error ".concat(n)));a.a.removeListener("onSaveDocument")})),r&&"csv"===r.toLowerCase()&&!0===v.a.get("isShowAlertDialogForCSVSaving"))h.a.showDialog({dialogId:m.a.CONFIRM_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_CSV_SAVE_INFO"},currentTabIndex:0},(function(e){0===e?l.a.saveDocument(r):t(new Error("Canceled by user."))}));else{var i=r;"hwpx"===r&&(i="hwp"),l.a.saveDocument(i)}}))},P=function(){return l.a.isDocumentModified()},O=function(){return Object(c.d)(u.e)},C=function(){return Object(c.d)(u.h)},y=function(){return Object(c.d)(u.g)},I=function(){return Object(c.d)(u.f)},k=function(){return Object(c.d)(d.f).viewMode},T=function(){p.a.focus("DocInputField")}},413:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return P}));var r=n(23),o=n.n(r),a=n(32),i=n(19),c=n(20),u=n(30),s=n(29),l=n(102),f=n(387),d=n(11),p=n(0),h=n(34),m=n(39),v=n(18),b=n(14),g=n(49),w=n(12),P=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getDocumentInformation",value:function(){return O()}},{key:"exportAsImage",value:function(){return C().catch((function(e){return v.b.api.reject("The document could not be printed.","[".concat(e.message,"]"))}))}},{key:"printDocument",value:function(e,t){return y(e,t).catch((function(e){return v.b.api.reject("The new document could not be opened.","[".concat(e.message,"]"))}))}}]),n}(f.default),O=function(){var e=d.a.getSummaryData(),t=e.szTitle,n=e.szAuthor,r=e.szModifiedBy,o=e.nWords,a=d.a.getWordCountStatistic(!0),i=a.nPageCnt,c=a.nWordCnt,u=a.nCharCnt,s=a.nCharWithoutSpaceCnt,l=a.nParaCnt,f=a.nLineCnt;return{title:t,author:n,modifiedBy:r,characters:s.toString(),characterBlank:u.toString(),words:o?null===o||void 0===o?void 0:o.toString():"",wordsSelection:c.toString(),lines:f.toString(),paragraphs:l.toString(),pages:i.toString(),manuscript:Math.ceil(c/200).toString()}},C=function(){return new Promise((function(e,t){var n=d.a.getConfig().nTotalPages,r=[],o=setTimeout((function(){r.length!==n&&t(new Error("\n                        The file is too large to print."))}),1e4);l.a.setListener("onExportAsImage",(function(t,a){a&&(r[t-1]=a),r.length===n&&(e({blobs:r}),l.a.removeListener("onExportAsImage"),clearTimeout(o))})),d.a.setPrint(p.BrPrintPaperSize.BR_PRINT_PAGESIZE_A4,1,n,p.PRINT_OPTION_MODE.PRINT_JPG_IMG,p.BrPrintResolution.BR_PRINT_150)}))},y=function(e,t){return new Promise(function(){var n=Object(a.a)(o.a.mark((function n(r,a){var i;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=function(){I(t).then((function(){r()})).catch((function(){a()}))},e?h.a.showDialog({dialogId:m.a.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_PRINT_LAYOUT_ALERT_MESSAGE"},currentTabIndex:0},(function(){return i()})):i();case 2:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},I=function(e){return new Promise(function(){var t=Object(a.a)(o.a.mark((function t(n,r){var i,c,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C();case 2:i=t.sent,c=i.blobs,Array.isArray(c)||r("Can't print pages."),(u=window.open(".".concat("","/print.html")))||r("Can't open new window for print"),Object(b.e)(u,"load",Object(a.a)(o.a.mark((function t(){var r,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=c.length,a=0;case 2:if(!(a<r)){t.next=8;break}return t.next=5,k(u,c[a],a+1,r,e);case 5:a+=1,t.next=2;break;case 8:n();case 9:case"end":return t.stop()}}),t)}))));case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},k=function(){var e=Object(a.a)(o.a.mark((function e(t,n,r,i,c){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(a.a)(o.a.mark((function e(a,u){var s,l,f,d,p,h,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=g.localeIntl.formatMessage,l=document.createElement("canvas"),f=l.getContext("2d"),d=793,p=1122,e.next=8,Object(b.s)(n);case 8:if(h=e.sent,l.width=h.width,l.height=h.height,m=h.height>h.width,null===f||void 0===f||f.drawImage(h,0,0),!f||!c){e.next=16;break}return e.next=16,T(f,r,c);case 16:t.postMessage({status:"progress",image:l.toDataURL(),totalPage:i,curPage:r,width:m?d:p,height:m?p:d,waitingMsg:s({id:"PREPARING_TO_PRINT_MESSAGE"}),cancelText:s({id:"MSG_BOX_CANCEL"})},window.location.origin),r===i?setTimeout((function(){t.postMessage({status:"end"},window.location.origin),a()}),10):setTimeout((function(){a()}),10),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),u(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r,o,a){return e.apply(this,arguments)}}(),T=function(e,t,n){return new Promise(function(){var r=Object(a.a)(o.a.mark((function r(a,i){var c,u,s,l,f,d,p,h;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,n){r.next=3;break}return r.abrupt("return",a());case 3:c=0;case 4:if(!(c<n.length)){r.next=18;break}if(u=n[c],s=u.imageBlob,l=u.text,f=u.textSize,d=u.posX,p=u.posY,u.pageNumberToPrint.includes(t)){r.next=9;break}return r.abrupt("continue",15);case 9:if(Object(w.isEmpty)(l)||(f&&(e.font="".concat(f,"px sans-serif")),e.fillText(l||"",d,p)),!(s&&s instanceof Blob)){r.next=15;break}return r.next=13,Object(b.s)(s);case 13:h=r.sent,e.drawImage(h,d,p,h.width,h.height);case 15:c+=1,r.next=4;break;case 18:a(),r.next=24;break;case 21:r.prev=21,r.t0=r.catch(0),i(r.t0);case 24:case"end":return r.stop()}}),r,null,[[0,21]])})));return function(e,t){return r.apply(this,arguments)}}())}},511:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return E}));var r,o=n(8),a=n(23),i=n.n(a),c=n(32),u=n(19),s=n(20),l=n(30),f=n(29),d=n(12),p=n(102),h=n(388),m=n(510),v=n(11),b=n(0),g=n(49),w=n(34),P=n(39),O=n(18),C=n(130),y=n(14),I=n(10),k=n(33),T=n(37),x=n(45),A=n(413);!function(e){e.all="all",e.current_page="current_page",e.custom_range="custom_range"}(r||(r={}));var E=function(e){Object(l.a)(n,e);var t=Object(f.a)(n);function n(){var e;return Object(u.a)(this,n),(e=t.call(this)).commonAPI=void 0,e.wordControlAPI=void 0,e.commonAPI=new h.default,e.wordControlAPI=new m.default,e}return Object(s.a)(n,[{key:"saveDocument",value:function(){return this.commonAPI.saveDocument()}},{key:"isModified",value:function(){return this.commonAPI.isModified()}},{key:"getViewMode",value:function(){return this.commonAPI.getViewMode()}},{key:"activeInput",value:function(){return this.commonAPI.activeInput()}},{key:"getDocContentRect",value:function(){return this.commonAPI.getDocContentRect()}},{key:"getTitleBarRect",value:function(){return this.commonAPI.getTitleBarRect()}},{key:"getRibbonTabMenuRect",value:function(){return this.commonAPI.getRibbonTabMenuRect()}},{key:"getRibbonBarRect",value:function(){return this.commonAPI.getRibbonBarRect()}},{key:"isProtectedDocument",value:function(){return this.commonAPI.isProtectedDocument()}},{key:"openNewDocument",value:function(){return R().catch((function(e){return O.b.api.reject("The new document could not be opened.","[".concat(e.message,"]"))}))}},{key:"getDocumentInformation",value:function(){return S()}},{key:"exportAsImage",value:function(){return _()}},{key:"printDocument",value:function(e,t){return L(e,t).catch((function(e){return O.b.api.reject("The new document could not be opened.","[".concat(e.message,"]"))}))}},{key:"exportAsPDF",value:function(e){var t=e.target,n=e.isPdfAExport,o=e.customRange,a="The document could not be exported as pdf.";return Object(d.isNil)(t)||"string"!==typeof t||!(t in r)?O.b.api.reject(a,"['target' argument is invalid . Please set a valid 'target' argument and try again.]"):Object(d.isNil)(n)||"boolean"!==typeof n?O.b.api.reject(a,"['isPdfAExport' argument is invalid . Please set a valid 'target' argument and try again.]"):t!==r.custom_range||!Object(d.isNil)(o)&&"string"===typeof o?j(e).catch((function(e){return O.b.api.reject(a,"[".concat(e.message,"]"))})):O.b.api.reject(a,"['customRange' argument is invalid . Please set a valid 'customRange' argument and try again.]")}},{key:"SetCurFieldProtectCell",value:function(e){var t=v.a.getTableAtt();return t.bProtected=e?1:0,Object(y.u)(t,"nMask",b.TablePropertyAttBits.BR_TABLE_PROPERTY_PROTECTED),v.a.setUndoContinue(!0),v.a.setTableAtt(t),v.a.setUndoContinue(!1),!0}},{key:"insertImage",value:function(e,t){try{return M(e,t)}catch(n){return O.b.api.reject("","[".concat(n.message,"]"))}}},{key:"insertHyperlink",value:function(e,t){D(e,t)}},{key:"CreateAction",value:function(e){return this.wordControlAPI.CreateAction(e)}},{key:"CreateSet",value:function(e){return this.wordControlAPI.CreateSet(e)}},{key:"Run",value:function(e){return this.wordControlAPI.Run(e)}},{key:"Clear",value:function(){return this.wordControlAPI.Clear()}},{key:"FieldExist",value:function(e){return this.wordControlAPI.FieldExist(e)}},{key:"GetCurFieldName",value:function(e){return this.wordControlAPI.GetCurFieldName(e)}},{key:"SetCurFieldName",value:function(e,t,n,r){return this.wordControlAPI.SetCurFieldName(e,t,n,r)}},{key:"GetFieldList",value:function(e,t){return this.wordControlAPI.GetFieldList(e,t)}},{key:"GetFieldText",value:function(e){return this.wordControlAPI.GetFieldText(e)}},{key:"PutFieldText",value:function(e,t){return this.wordControlAPI.PutFieldText(e,t)}},{key:"RenameField",value:function(e,t){return this.wordControlAPI.RenameField(e,t)}},{key:"CreateField",value:function(e,t,n){return this.wordControlAPI.CreateField(e,t,n)}},{key:"MoveToField",value:function(e,t,n,r){return this.wordControlAPI.MoveToField(e,t,n,r)}},{key:"MoveToFieldEx",value:function(e,t,n,r){return this.wordControlAPI.MoveToFieldEx(e,t,n,r)}},{key:"MovePos",value:function(e,t,n){return this.wordControlAPI.MovePos(e,t,n)}},{key:"InsertPicture",value:function(e,t,n,r,o,a,i,c){return this.wordControlAPI.InsertPicture(e,t,n,r,o,a,i,c)}},{key:"GetTextFile",value:function(e,t){return this.wordControlAPI.GetTextFile(e,t)}},{key:"GetPosBySet",value:function(){return this.wordControlAPI.GetPosBySet()}},{key:"GetTextBySet",value:function(e){return this.wordControlAPI.GetTextBySet(e)}},{key:"InitScan",value:function(e,t,n,r,o,a){return this.wordControlAPI.InitScan(e,t,n,r,o,a)}},{key:"ReleaseScan",value:function(){return this.wordControlAPI.ReleaseScan()}},{key:"CellShape",get:function(){return this.wordControlAPI.CellShape},set:function(e){this.wordControlAPI.CellShape=e}},{key:"CharShape",get:function(){return this.wordControlAPI.CharShape},set:function(e){this.wordControlAPI.CharShape=e}},{key:"EditMode",get:function(){return this.wordControlAPI.EditMode},set:function(e){this.wordControlAPI.EditMode=e}},{key:"CurFieldState",get:function(){return this.wordControlAPI.CurFieldState},set:function(e){this.wordControlAPI.CurFieldState=e}},{key:"ViewProperties",get:function(){return this.wordControlAPI.ViewProperties},set:function(e){this.wordControlAPI.ViewProperties=e}}]),n}(A.default),R=function(){return new Promise(function(){var e=Object(c.a)(i.a.mark((function e(t,n){var r,o,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(I.c)(Object(T.f)("hwp"));try{r=Object(I.d)(T.b),o=r.extension,a=Object(I.d)(x.d),p.a.setListener("onOpenComplete",(function(){t(),p.a.removeListener("onOpenComplete")})),C.a.setOpenMode(b.EPROTECT_READ_MODE.ePRM_COMMON),v.a.newDocument(".".concat("hwpx"===o.toLowerCase()?"hwp":o),a.width,a.height),Object(I.c)(Object(k.j)(!0))}catch(i){n(i)}case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},S=function(){var e=v.a.getSummaryData(),t=e.szTitle,n=e.szAuthor,r=e.szModifiedBy,o=e.nWords,a=v.a.getWordCountStatistic(!0),i=a.nPageCnt,c=a.nWordCnt,u=a.nCharCnt,s=a.nCharWithoutSpaceCnt,l=a.nParaCnt,f=a.nLineCnt;return{title:t,author:n,modifiedBy:r,characters:s.toString(),characterBlank:u.toString(),words:o?null===o||void 0===o?void 0:o.toString():"",wordsSelection:c.toString(),lines:f.toString(),paragraphs:l.toString(),pages:i.toString(),manuscript:Math.ceil(c/200).toString()}},_=function(){return new Promise((function(e,t){var n=v.a.getConfig().nTotalPages,r=[],o=setTimeout((function(){r.length!==n&&t(new Error("\n                        The file is too large to print."))}),1e4);p.a.setListener("onExportAsImage",(function(t,a){a&&(r[t-1]=a),r.length===n&&(e({blobs:r}),p.a.removeListener("onExportAsImage"),clearTimeout(o))})),v.a.setPrint(b.BrPrintPaperSize.BR_PRINT_PAGESIZE_A4,1,n,b.PRINT_OPTION_MODE.PRINT_JPG_IMG,b.BrPrintResolution.BR_PRINT_150)}))},j=function(e){return new Promise((function(t,n){var o=e.target,a=e.isPdfAExport,i=e.customRange,c=Object(I.d)(T.b),u=c.docName,s=c.extension;p.a.setListener("onSaveDocument",(function(e,r){if(e===b.ResultOnSaveDocument.kPoProcessSucess&&r){var o="".concat(u.replace(new RegExp(".".concat(s,"$")),".pdf"));t({name:o,blob:r})}else n(new Error("Error ".concat(e)));p.a.removeListener("onSaveDocument")}));var l=0,f=[];switch(o){case r.all:break;case r.current_page:var d=v.a.getConfig().nCurPage;l=1,f.push(d);break;case r.custom_range:if(!i)return;i.split(",").forEach((function(e){if(e.indexOf("-")>0){var t=e.split("-");if(2!==t.length)return;var n=parseInt(t[0]),r=parseInt(t[1]);if(isNaN(n)||isNaN(r))return;for(var o=n;o<=r;o+=1)f.push(o)}else{var a=parseInt(e);if(isNaN(a))return;f.push(a)}})),l=(f=Array.from(new Set(f))).length}v.a.saveDocument("pdf",b.BR_SAVE_OPTION.BR_SAVE_OPTION_TEMP_SAVE,a,!1,l,f,!1,400)}))},M=function(e,t){return new Promise(function(){var n=Object(c.a)(i.a.mark((function n(r,o){var a,c,u,s,l;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(y.r)(e);case 3:if((a=n.sent)instanceof ArrayBuffer){n.next=6;break}return n.abrupt("return");case 6:c=(null===t||void 0===t?void 0:t.width)||0,u=(null===t||void 0===t?void 0:t.height)||0,0,s=(null===t||void 0===t?void 0:t.posX)||0,l=(null===t||void 0===t?void 0:t.posY)||0,v.a.imageInsert(a,c,u,0,s,l),r(),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(0),o(n.t0);case 18:case"end":return n.stop()}}),n,null,[[0,15]])})));return function(e,t){return n.apply(this,arguments)}}())},D=function(e,t){if(!Object(d.isEmpty)(e)){var n=Object(o.a)(Object(o.a)({},Object(b.initBrGuiHyperLinkEditorEvent)()),{},{nLinkType:b.EV_HYPERLINK_TYPE.EV_LINK_TO_URL,nRunType:b.EV_HYPERLINK_RUN_TYPE.EV_LINK_RUNTYPE_MOUSE_CLICK,szHyperLink:e||"",szHyperText:t||""});v.a.setHyperLinkInfoFromJson(n)}},L=function(e,t){return new Promise(function(){var n=Object(c.a)(i.a.mark((function n(r,o){var a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=function(){N(t).then((function(){r()})).catch((function(){o()}))},e?w.a.showDialog({dialogId:P.a.COMMON_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_PRINT_LAYOUT_ALERT_MESSAGE"},currentTabIndex:0},(function(){return a()})):a();case 2:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},N=function(e){return new Promise(function(){var t=Object(c.a)(i.a.mark((function t(n,r){var o,a,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_();case 2:o=t.sent,a=o.blobs,Array.isArray(a)||r("Can't print pages."),(u=window.open(".".concat("","/print.html")))||r("Can't open new window for print"),Object(y.e)(u,"load",Object(c.a)(i.a.mark((function t(){var r,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=a.length,o=0;case 2:if(!(o<r)){t.next=8;break}return t.next=5,B(u,a[o],o+1,r,e);case 5:o+=1,t.next=2;break;case 8:n();case 9:case"end":return t.stop()}}),t)}))));case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},B=function(){var e=Object(c.a)(i.a.mark((function e(t,n,r,o,a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(i.a.mark((function e(c,u){var s,l,f,d,p,h,m;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=g.localeIntl.formatMessage,l=document.createElement("canvas"),f=l.getContext("2d"),d=793,p=1122,e.next=8,Object(y.s)(n);case 8:if(h=e.sent,l.width=h.width,l.height=h.height,m=h.height>h.width,null===f||void 0===f||f.drawImage(h,0,0),!f||!a){e.next=16;break}return e.next=16,F(f,r,a);case 16:t.postMessage({status:"progress",image:l.toDataURL(),totalPage:o,curPage:r,width:m?d:p,height:m?p:d,waitingMsg:s({id:"PREPARING_TO_PRINT_MESSAGE"}),cancelText:s({id:"MSG_BOX_CANCEL"})},window.location.origin),r===o?setTimeout((function(){t.postMessage({status:"end"},window.location.origin),c()}),10):setTimeout((function(){c()}),10),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),u(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r,o,a){return e.apply(this,arguments)}}(),F=function(e,t,n){return new Promise(function(){var r=Object(c.a)(i.a.mark((function r(o,a){var c,u,s,l,f,p,h,m;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,n){r.next=3;break}return r.abrupt("return",o());case 3:c=0;case 4:if(!(c<n.length)){r.next=18;break}if(u=n[c],s=u.imageBlob,l=u.text,f=u.textSize,p=u.posX,h=u.posY,u.pageNumberToPrint.includes(t)){r.next=9;break}return r.abrupt("continue",15);case 9:if(Object(d.isEmpty)(l)||(f&&(e.font="".concat(f,"px sans-serif")),e.fillText(l||"",p,h)),!(s&&s instanceof Blob)){r.next=15;break}return r.next=13,Object(y.s)(s);case 13:m=r.sent,e.drawImage(m,p,h,m.width,m.height);case 15:c+=1,r.next=4;break;case 18:o(),r.next=24;break;case 21:r.prev=21,r.t0=r.catch(0),a(r.t0);case 24:case"end":return r.stop()}}),r,null,[[0,21]])})));return function(e,t){return r.apply(this,arguments)}}())}}}]);