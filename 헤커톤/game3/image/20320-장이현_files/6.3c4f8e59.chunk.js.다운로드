(this["webpackJsonppolaris-weboffice"]=this["webpackJsonppolaris-weboffice"]||[]).push([[6],{3248:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return D}));var o,r=n(19),a=n(20),c=n(10),u=n(182),i=n(33),s=n(15),l=n(34),f=n(39),v=n(55),d=n(11),p=n(0),h=n(12),O=n(24);!function(e){e[e.NATIVE_CLIPBOARD=0]="NATIVE_CLIPBOARD",e[e.EXTERNAL_CLIPBOARD=1]="EXTERNAL_CLIPBOARD"}(o||(o={}));var b=/<!--\[if gte vml 1\]>/g,m=/<!\[endif\]-->/g,M=/<!--\[PO\]\[if gte vml 1\]>/g,g=/<!\[endif\]\[PO\]-->/g,D=function(){function e(){Object(r.a)(this,e),this.clipboardDataTransfer=null,this.nativeCopyIdAttrName="nativecopyid",this.nativeCopyIdValue="",this.isNativeMode=!1,this.isCopyFormatMode=!1}return Object(a.a)(e,[{key:"setNativeMode",value:function(e){return this.isNativeMode!==e&&(this.isNativeMode=e,Object(c.c)(Object(u.c)(e)),this.isNativeMode||(this.nativeCopyIdValue=""),!0)}},{key:"getNavtiveMode",value:function(){return this.isNativeMode}},{key:"setCopyFormatMode",value:function(e){return this.isCopyFormatMode!==e&&(this.isCopyFormatMode=e,Object(c.c)(Object(u.b)(this.isCopyFormatMode)),!0)}},{key:"getCopyFormatMode",value:function(){return this.isCopyFormatMode}},{key:"showAlert",value:function(e,t){e===f.a.COMMON_CLIPBOARD?l.a.showDialog({dialogId:e,bModal:!0,currentTabIndex:0}):l.a.showDialog({dialogId:e,bModal:!0,alertMsg:{label:t},currentTabIndex:0})}},{key:"canEdit",value:function(){return Object(c.d)(i.f).viewMode===s.n.edit}},{key:"copy",value:function(e){this.clipboardDataTransfer=e,d.a.editDocument(p.BrEditMode.BR_EDITMODE_COPY,p.ClipDataType.CLIPDATA_FAVORITE_DATA,null,o.NATIVE_CLIPBOARD)}},{key:"cut",value:function(e){this.canEdit()&&(this.clipboardDataTransfer=e,d.a.editDocument(p.BrEditMode.BR_EDITMODE_CUT,p.ClipDataType.CLIPDATA_STR,null,o.NATIVE_CLIPBOARD))}},{key:"nativePaste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p.BrEditMode.BR_EDITMODE_PASTE,t=O.a.get("preventPasteFromExternal");this.isNativeMode||t?d.a.editDocument(e,p.ClipDataType.CLIPDATA_STR,null,o.NATIVE_CLIPBOARD):this.showAlert(f.a.COMMON_CLIPBOARD,"")}},{key:"externalPaste",value:function(e,t){d.a.editDocument(p.BrEditMode.BR_EDITMODE_ORIGINAL_FORMAT,t,t===p.ClipDataType.CLIPDATA_HTML?this.excludeImgElements(e):e,o.EXTERNAL_CLIPBOARD),this.setNativeMode(!1)}},{key:"appendClipboardImage",value:function(e){for(var t=0;t<e.length;t+=1){var n=e[0];n&&function(){var e=new FileReader;e.onload=function(){if(e.readyState===FileReader.DONE&&e.result instanceof ArrayBuffer){var t=e.result;d.a.imageInsert(t,0,0,0,0,0)}},e.readAsArrayBuffer(n)}()}}},{key:"clipboardPaste",value:function(e){if(this.canEdit()){var t=e.getData&&e.getData("text/plain"),n=e.getData&&e.getData("text/html"),o=!Object(h.isEmpty)(n),r=!Object(h.isEmpty)(t),a=o&&n.includes("".concat(this.nativeCopyIdAttrName,'="').concat(this.nativeCopyIdValue,'"')),c=e.files&&e.files.length>0,u=O.a.get("preventPasteFromExternal");a||u?this.nativePaste():c&&!r?this.appendClipboardImage(e.files):o&&this.htmlDataTagCount(n)>0?this.externalPaste(n,p.ClipDataType.CLIPDATA_HTML):r&&this.externalPaste(t,p.ClipDataType.CLIPDATA_STR)}}},{key:"htmlDataTagCount",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=document.createElement("div");n.innerHTML=e;var o=n.getElementsByTagName(t).length;return n.remove(),o}},{key:"createClipboardElement",value:function(e){var t=document.createElement("div");return t.innerHTML=this.excludeVML(e),document.body.appendChild(t),t.children[0]&&(this.nativeCopyIdValue="".concat(Math.floor(1e5*Math.random())+1),t.children[0].setAttribute(this.nativeCopyIdAttrName,this.nativeCopyIdValue)),t}},{key:"copyToClipboard",value:function(e,t){var n=null;if(t===p.ClipDataType.CLIPDATA_STR)(n=document.createElement("textarea")).value=e,document.body.appendChild(n),n.select(),document.execCommand("copy");else{n=this.createClipboardElement(e);var o=document.createRange();o.selectNodeContents(n);var r=window.getSelection();if(r){var a,c,u=[];if(r.rangeCount>0)for(var i=0;i<r.rangeCount;i+=1){var s=r.getRangeAt(i);u.push(s)}if(r.removeAllRanges(),r.addRange(o),document.execCommand("copy"),r.removeAllRanges(),u&&u.length>0)for(var l=0;l<u.length;l+=1)r.addRange(u[l]);var f=null===(a=v.a.getForcusRef("DocInputField"))||void 0===a||null===(c=a.elementRef)||void 0===c?void 0:c.current;f&&f instanceof HTMLInputElement&&f.select()}}n.remove(),v.a.focus("DocInputField")}},{key:"isDuplicatedShape",value:function(e){var t=document.createElement("div");t.innerHTML=e.replace(b,"").replace(m,"");for(var n=t.getElementsByTagName("img"),o=0;o<n.length;o+=1){var r=n[o].getAttribute("v:shapes");if(!Object(h.isEmpty)(r)){var a=t.querySelector('[id="'.concat(r,'"]'));if(!a||!a.tagName||!a.tagName.toLowerCase().startsWith("v:"))return!1}}return!0}},{key:"excludeVML",value:function(e){if(!this.isDuplicatedShape(e))return e;var t=e;return t=(t=t.replace(b,"\x3c!--[PO][if gte vml 1]>")).replace(m,"<![endif][PO]--\x3e")}},{key:"excludeImgElements",value:function(e){if(!M.test(e)||!g.test(e))return e;var t=document.createElement("div");t.innerHTML=e.replace(M,"").replace(g,"");var n=document.createElement("div");n.innerHTML=e.replace(M,"\x3c!--[if gte vml 1]>").replace(g,"<![endif]--\x3e");for(var o=n.getElementsByTagName("img"),r=o.length-1;r>=0;r-=1){var a=o[r],c=a.getAttribute("v:shapes");if(!Object(h.isEmpty)(c)){var u=t.querySelector('[id="'.concat(c,'"]'));u&&u.tagName&&u.tagName.toLowerCase().startsWith("v:")&&a.remove()}}return n.innerHTML}}]),e}()},3249:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l}));var o,r,a,c=n(19),u=n(20),i=n(6);!function(e){e[e.Down=0]="Down",e[e.Move=1]="Move",e[e.Up=2]="Up",e[e.Drag=3]="Drag",e[e.Drop=4]="Drop"}(o||(o={})),function(e){e[e.Enter=0]="Enter",e[e.Leave=1]="Leave"}(r||(r={})),function(e){e[e.Over=0]="Over",e[e.Out=1]="Out"}(a||(a={}));var s=function(e){var t=Object(i.useRef)(),n=Object(i.useRef)(),c=Object(i.useRef)(),u=Object(i.useRef)({});Object(i.useEffect)((function(){u.current=e}),[e]);var s=Object(i.useCallback)((function(e){n.current===r.Leave&&(l.onMouseMove(),t.current=o.Drag,u.current.onMouseDrag&&u.current.onMouseDrag(e,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:c.current}))}),[]),f=Object(i.useCallback)((function(e){document.removeEventListener("mousemove",s,!0),document.removeEventListener("mouseup",f,!0),c.current===a.Out&&t.current===o.Drag&&(l.onMouseUp(),t.current=o.Drop,u.current.onMouseDrop&&u.current.onMouseDrop(e,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:c.current}))}),[s]),v=Object(i.useMemo)((function(){return{onMouseDown:function(r){l.onMouseDown(),t.current=o.Down,e.onMouseDown&&e.onMouseDown(r,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:c.current}),document.addEventListener("mousemove",s,!0),document.addEventListener("mouseup",f,!0)},onMouseMove:function(r){l.onMouseMove(),t.current===o.Down||t.current===o.Drag?t.current=o.Drag:t.current=o.Move,t.current===o.Drag&&e.onMouseDrag?e.onMouseDrag(r,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:c.current}):e.onMouseMove&&e.onMouseMove(r,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:c.current})},onMouseUp:function(r){l.onMouseUp(),t.current===o.Drag?t.current=o.Drop:t.current=o.Up,t.current===o.Drop&&e.onMouseDrop?e.onMouseDrop(r,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:c.current}):e.onMouseUp&&e.onMouseUp(r,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:c.current})},onMouseEnter:function(o){n.current=r.Enter,e.onMouseEnter&&e.onMouseEnter(o,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:c.current})},onMouseLeave:function(o){n.current=r.Leave,e.onMouseLeave&&e.onMouseLeave(o,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:c.current})},onMouseOver:function(o){c.current=a.Over,e.onMouseOver&&e.onMouseOver(o,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:c.current})},onMouseOut:function(o){c.current=a.Out,e.onMouseOut&&e.onMouseOut(o,{mouseStatus:t.current,mouseEnterLeaveStatus:n.current,mouseOverOutStatus:c.current})}}}),[e,s,f]);return[t,v]},l=new(function(){function e(){Object(c.a)(this,e),this.status=void 0}return Object(u.a)(e,[{key:"onMouseDown",value:function(){this.status=o.Down}},{key:"onMouseMove",value:function(){this.status===o.Down||this.status===o.Drag?this.status=o.Drag:this.status=o.Move}},{key:"onMouseUp",value:function(){this.status===o.Drag?this.status=o.Drop:this.status=o.Up}},{key:"current",get:function(){return this.status}}]),e}())},3250:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(6),r=function(){var e=Object(o.useRef)();return function(t){e.current&&window.cancelAnimationFrame(e.current),e.current=window.requestAnimationFrame((function(n){t(n),e.current=void 0}))}}},3402:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var o,r=n(8),a=n(27),c=n(5),u=n(6),i=n(17),s=n(7),l=n.n(s),f=n(38),v=n(45),d=n(33),p=n(11),h=n(0),O=n(93),b=n(173),m=n(73),M=n(3249),g=n(3250),D=n(55),y=n(181),j=n(56),T=n(22),S=n(14),C=n(3692),E=n(3777),I=n(15),_=n(68),A=n(77),L=n(83);function w(e){var t=Object(i.b)(),n=Object(u.useRef)(null),s=Object(O.b)((function(e){e&&b.a.initCanvas(e)})),w=Object(a.a)(s,2),k=w[0],N=w[1],K=Object(O.b)((function(e){e&&m.a.initCanvas(e)})),P=Object(a.a)(K,2),V=P[0],Y=P[1],X=Object(i.c)(f.c).cursorStyle,x=Object(i.c)(d.f).isAppReady,U=Object(i.c)(v.d),H=Object(i.c)(d.f).viewMode,B=Object(g.a)(),F=Object(u.useState)(o.None),z=Object(a.a)(F,2),Z=z[0],W=z[1],q=Object(u.useState)(0),G=Object(a.a)(q,2),J=G[0],Q=G[1],$=Object(i.c)(_.d).selectPentType,ee=Object(u.useState)(0),te=Object(a.a)(ee,2),ne=te[0],oe=te[1];Object(u.useEffect)((function(){var t=n.current;if(t){var o=function(t){if(!y.a.isShapeDrawing()||M.b.current!==M.a.Drag){var n=Math.sign(t.deltaY)>0;e.onWheel&&e.onWheel(t,{isPositive:n})||(B((function(){var e=t.ctrlKey,o=t.altKey,r=t.shiftKey;!e||o||r||H===I.n.presentation||(n?p.a.zoomOut():p.a.zoomIn())})),t.preventDefault(),t.stopPropagation())}};t.addEventListener("wheel",o,{passive:!1});var r=function(e){e.touches.length>1&&e.preventDefault(),oe(e.timeStamp)};return t.addEventListener("touchstart",r,{passive:!1}),function(){t.removeEventListener("wheel",o),t.removeEventListener("touchstart",r)}}}),[e,B,H]),Object(u.useEffect)((function(){var e=k.current,n=V.current,o=U.width,r=U.height;e&&n&&o>0&&r>0&&(e.width=o,e.height=r,n.width=o,n.height=r,t(x?Object(d.a)():Object(d.e)()))}),[k,U,x,t,V]);var re=Object(u.useCallback)((function(e,t){return{offsetX:Math.floor(e-U.left),offsetY:Math.floor(t-U.top)}}),[U]),ae=Object(u.useCallback)((function(e){var t,n;if(e.touches&&e.touches.length>1)t=e.touches[0].clientX,n=e.touches[0].clientY;else{var o=e.nativeEvent.changedTouches;t=o[0].clientX,n=o[0].clientY}return{clientX:t,clientY:n}}),[]),ce=Object(u.useMemo)((function(){return{onMouseDown:function(t,n){var o=re(t.clientX,t.clientY),a=o.offsetX,c=o.offsetY;e.onMouseDown&&e.onMouseDown(t,Object(r.a)(Object(r.a)({},n),{},{offsetX:a,offsetY:c}))||(H===I.n.edit&&D.a.focus("DocInputField"),R.hidAction(h.EV_HID_ACTION.eEV_HID_ACTION_DOWN,a,c,R.getModifierVK(t.button,t.ctrlKey,t.shiftKey)),t.preventDefault())},onMouseMove:function(t,n){var o=re(t.clientX,t.clientY),a=o.offsetX,c=o.offsetY;e.onMouseMove&&e.onMouseMove(t,Object(r.a)(Object(r.a)({},n),{},{offsetX:a,offsetY:c}))||M.b.current!==M.a.Drag&&(R.mouseHovering(a,c,t.shiftKey,t.ctrlKey,t.altKey),t.preventDefault())},onMouseUp:function(t,n){var o=re(t.clientX,t.clientY),a=o.offsetX,c=o.offsetY;e.onMouseUp&&e.onMouseUp(t,Object(r.a)(Object(r.a)({},n),{},{offsetX:a,offsetY:c}))||(m.a.clearSelectionArea(),R.hidAction(h.EV_HID_ACTION.eEV_HID_ACTION_UP,a,c,R.getModifierVK(t.button,t.ctrlKey,t.shiftKey)),t.preventDefault())},onMouseDrag:function(t,n){var o=re(t.clientX,t.clientY),a=o.offsetX,c=o.offsetY;e.onMouseDrag&&e.onMouseDrag(t,Object(r.a)(Object(r.a)({},n),{},{offsetX:a,offsetY:c}))||(m.a.resizeSelectionArea({nX:a,nY:c}),R.hidAction(h.EV_HID_ACTION.eEV_HID_ACTION_MOVE,a,c,R.getModifierVK(t.button,t.ctrlKey,t.shiftKey)),t.preventDefault())},onMouseDrop:function(t,n){var a=re(t.clientX,t.clientY),c=a.offsetX,u=a.offsetY;e.onMouseDrop&&e.onMouseDrop(t,Object(r.a)(Object(r.a)({},n),{},{offsetX:c,offsetY:u}))||(m.a.clearSelectionArea(),Z!==o.Swiping&&R.hidAction(h.EV_HID_ACTION.eEV_HID_ACTION_UP,c,u,R.getModifierVK(t.button,t.ctrlKey,t.shiftKey)),t.preventDefault())}}}),[re,e,H,Z]),ue=Object(M.c)(ce),ie=Object(a.a)(ue,2)[1],se=Object(u.useMemo)((function(){return{onTouchStart:function(n){var r=ae(n),a=r.clientX,c=r.clientY,u=re(a,c),i=u.offsetX,s=u.offsetY;e.onTouchStart&&e.onTouchStart(n)||(R.hidAction(h.EV_HID_ACTION.eEV_HID_ACTION_DOWN,i,s,R.getModifierVK(0,!1,!1),0,0,!0),n.touches&&2===n.touches.length&&(n.nativeEvent.preventDefault(),n.nativeEvent.stopPropagation()),W(o.None),t(Object(A.c)(!1)))},onLongTouch:function(t){var n=ae(t),o=n.clientX,r=n.clientY,a=re(o,r),c=a.offsetX,u=a.offsetY;R.hidAction(h.EV_HID_ACTION.eEV_HID_ACTION_DOWN,c,u,R.getModifierVK(0,t.ctrlKey,t.shiftKey)),R.hidAction(h.EV_HID_ACTION.eEV_HID_ACTION_DBLCLK,c,u,R.getModifierVK(0,t.ctrlKey,t.shiftKey)),R.hidAction(h.EV_HID_ACTION.eEV_HID_ACTION_UP,c,u,R.getModifierVK(0,t.ctrlKey,t.shiftKey)),e.onLongTouch&&e.onLongTouch(t)},onTouchMove:function(t,n){var o=ae(t),r=o.clientX,a=o.clientY,c=re(r,a),u=c.offsetX,i=c.offsetY,s=n.touchStatus,l=n.firstTouchList,f=n.lastTouchList,v=n.zoomRatio;if(!e.onTouchMove||!e.onTouchMove(t,n))if(s===C.a.Move){if(!t.touches||!f)return;R.hidAction(h.EV_HID_ACTION.eEV_HID_ACTION_MOVE,u,i,R.getModifierVK(0,!1,!1),0,0,!0)}else if(s===C.a.Scaling){if(!v)return;if(!t.touches||2!==t.touches.length||!l)return;var d=v.startZoomRatio,O=v.minZoomRatio,b=v.maxZoomRatio,m=t.touches[0].clientX-t.touches[1].clientX,M=t.touches[0].clientY-t.touches[1].clientY,g=Math.sqrt(Math.abs(m*m)+Math.abs(M*M)),D=l[0].clientX-l[1].clientX,y=l[0].clientY-l[1].clientY,j=Math.sqrt(Math.abs(D*D)+Math.abs(y*y)),T=Math.abs(d*(1+(g-j)/j));T=Math.floor(Math.max(Math.min(T,b),O)),Math.abs(J-T)>200&&(p.a.setZoom(T),Q(T)),t.nativeEvent.preventDefault(),t.nativeEvent.stopPropagation()}},onTouchEnd:function(n){var r=ae(n),a=r.clientX,c=r.clientY,u=re(a,c),i=u.offsetX,s=u.offsetY;Z!==o.Swiped&&R.hidAction(h.EV_HID_ACTION.eEV_HID_ACTION_UP,i,s,R.getModifierVK(0,!1,!1),0,0,!0),2===n.touches.length&&(n.nativeEvent.preventDefault(),n.nativeEvent.stopPropagation()),e.onTouchEnd&&e.onTouchEnd(n)||setTimeout((function(){var e=p.a.getMarkStringLength()>0?p.a.getMarkString():"";t(Object(L.f)(e)),t(Object(A.c)(!0))}),200)}}}),[J,t,ae,re,e,Z]),le=Object(C.b)(se),fe=Object(u.useCallback)((function(e){e.preventDefault(),e.stopPropagation()}),[]),ve=Object(u.useCallback)((function(e){e.preventDefault(),e.stopPropagation()}),[]),de=Object(u.useCallback)((function(t){var n=re(t.clientX,t.clientY),o=n.offsetX,r=n.offsetY;e.onDoubleClick&&e.onDoubleClick(t,{offsetX:o,offsetY:r})||(R.hidAction(h.EV_HID_ACTION.eEV_HID_ACTION_DBLCLK,o,r,R.getModifierVK(t.button,t.ctrlKey,t.shiftKey)),R.hidAction(h.EV_HID_ACTION.eEV_HID_ACTION_UP,o,r,R.getModifierVK(t.button,t.ctrlKey,t.shiftKey)))}),[e,re]),pe=Object(u.useCallback)((function(t){var n=re(t.clientX,t.clientY),o=n.offsetX,r=n.offsetY;if((!e.onContextMenu||!e.onContextMenu(t,{offsetX:o,offsetY:r}))&&!y.a.isShapeDrawing()){var a=S.b.getAppBoundingClientRect(t.currentTarget),c={type:T.a.DocFrame,posX:a.left+o,posY:a.top+r,limitPosX:a.right,limitPosY:a.bottom,offsetX:o,offsetY:r};j.a.showContextMenu(c),t.preventDefault(),t.stopPropagation()}}),[e,re]),he=Object(E.useSwipeable)({onSwiping:function(t){Object(_.c)($)||e.onSwiping&&e.onSwiping(t)||W(o.Swiping)},onSwiped:function(t){var n=t.event,r=t.absX,a=t.absY,c=(n.timeStamp||0)-ne;if(!(Math.sqrt(r*r+a*a)/(c||1)<1)&&!Object(_.c)($)&&(!e.onSwiped||!e.onSwiped(t))){var u=t.vxvy,i=t.initial,s=t.deltaX,l=t.deltaY,f=re(i[0]+s,i[1]+l),v=f.offsetX,d=f.offsetY,O=1e3*u[0]*-1,b=1e3*u[1]*-1;p.a.flick(Math.floor(O),Math.floor(b)),R.hidAction(h.EV_HID_ACTION.eEV_HID_ACTION_UP,v,d,R.getModifierVK(0,!1,!1),0,0,!0),W(o.Swiped)}},preventDefaultTouchmoveEvent:!0,trackMouse:!1,trackTouch:!0}),Oe=Object(u.useMemo)((function(){return Object(c.jsx)("canvas",{className:X.type===f.a.ClassName?X.value:"",style:{cursor:X.type===f.a.InlineStyle?"url(".concat(X.value,"), auto"):""},ref:N})}),[X.type,X.value,N]),be=Object(u.useMemo)((function(){return Object(c.jsx)("canvas",{className:X.type===f.a.ClassName?X.value:"",style:{cursor:X.type===f.a.InlineStyle?"url(".concat(X.value,"), auto"):""},ref:Y})}),[X.type,X.value,Y]);return Object(c.jsxs)("div",Object(r.a)(Object(r.a)(Object(r.a)({className:l.a.canvas,ref:n},ie),le),{},{onDragOver:ve,onDrop:fe,onDoubleClick:de,onContextMenu:pe,children:[Object(c.jsx)("div",Object(r.a)(Object(r.a)({},he),{},{children:Oe})),Object(c.jsx)("div",{children:be})]}))}!function(e){e[e.None=0]="None",e[e.Swiping=1]="Swiping",e[e.Swiped=2]="Swiped"}(o||(o={}));var R={getModifierVK:function(e,t,n){var o=0;return t&&n?o=h.VirtualKeys.VK_CTRL_SHIFT:t?o=h.VirtualKeys.VK_CONTROL:n&&(o=h.VirtualKeys.VK_SHIFT),o},hidAction:function(e,t,n,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];p.a.HIDAction(e,t,n,o,r,a,c)},mouseHovering:function(e,t,n,o,r){p.a.mouseHovering(e,t,n,o,r)}}},3403:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var o=n(8),r=n(27),a=n(5),c=n(6),u=n(7),i=n.n(u),s=n(55),l=n(58),f=n(88),v=n(3693),d=n(11),p=n(0),h=n(92),O=n(121),b=n(73),m=n(17),M=n(37),g=n(15),D=n(33),y=n(14),j=n(68),T=n(10);function S(e){var t=Object(c.useRef)(null),n=Object(s.b)({id:"DocInputField",elementRef:t}),u=Object(r.a)(n,2)[1],h=Object(c.useState)(""),j=Object(r.a)(h,2),T=j[0],S=j[1],E=Object(c.useMemo)((function(){var e=b.a.getCaretInfo();return{left:null===e||void 0===e?void 0:e.x,top:null===e||void 0===e?void 0:e.y,inputChar:T}}),[T]),I=E.left,_=E.top,A=Object(m.c)(M.b).docType,L=Object(m.c)(D.f).viewMode;Object(c.useEffect)((function(){var e=t.current;e&&(y.j||L!==g.n.edit?e.setAttribute("readOnly","readOnly"):e.removeAttribute("readOnly"))}),[t,L]);var w=Object(c.useMemo)((function(){return{left:"".concat(I,"px"),top:"".concat(_,"px")}}),[I,_]),R=Object(c.useMemo)((function(){return{onKeyDown:function(t,n){e.onKeyDown&&e.onKeyDown(t,n)||C(t,A)&&"Enter"!==t.key&&t.preventDefault()},onInput:function(t,n){if(!e.onInput||!e.onInput(t,n)){var o=t.nativeEvent;if(o){var r=o.inputType,a=o.isComposing,c=o.data;if(!a){switch(r){case"deleteContentBackward":d.a.charInsert(l.a.Backspace,!1,!1,!1);break;case"insertText":O.b.record(O.a.CompositionEnd,c),d.a.insertString(c,p.BrCompositionType.BR_IME_COMPOSITING_RESULT);break;case"insertReplacementText":d.a.charInsert(l.a.Backspace,!1,!1,!1),d.a.insertString(c,p.BrCompositionType.BR_IME_COMPOSITING_RESULT)}"insertParagraph"!==r&&" "!==c||(t.currentTarget.value="")}}}},onKeyUp:function(t,n){e.onKeyUp&&e.onKeyUp(t,n)}}}),[A,e]),k=Object(f.b)(R),N=Object(r.a)(k,2)[1],K=Object(c.useMemo)((function(){return{onCompositionStart:function(e,t){O.b.record(O.a.CompositionStart,e.data)},onCompositionUpdate:function(e,t){O.b.record(O.a.CompositionUpdate,e.data),d.a.insertString(e.data,p.BrCompositionType.BR_IME_COMPOSITING),S(e.data)},onCompositionEnd:function(e,t){var n=e.data;""===n&&(n=T),O.b.record(O.a.CompositionEnd,n),d.a.insertString(n,p.BrCompositionType.BR_IME_COMPOSITING_RESULT),e.currentTarget.value="",S("")}}}),[T,S]),P=Object(v.c)(K),V=Object(r.a)(P,2)[1],Y={onPaste:Object(c.useCallback)((function(t){e.onPaste&&e.onPaste(t)}),[e]),onCopy:Object(c.useCallback)((function(t){e.onCopy&&e.onCopy(t)}),[e]),onCut:Object(c.useCallback)((function(t){e.onCut&&e.onCut(t)}),[e])};return Object(a.jsx)("input",Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)({type:"text",className:i.a.inputfield,ref:t,style:w},u),N),V),Y))}var C=function(e,t){var n=e.keyCode,o=e.shiftKey,r=e.ctrlKey,a=e.altKey;if(l.b.NAVIGATION.includes(n))return d.a.caretMove(n,o,r,a,!1,t===g.b.hwp),!0;if(n===l.a.Backspace||n===l.a.Delete)return d.a.charInsert(n,o,r,a),!0;if(n===l.a.BackTick)return d.a.charInsert(o?126:96,o,r,a),!0;if(n===l.a.Enter)return d.a.isSheetEditingCell()?(a?(s.a.updateFocus("DocInputField"),d.a.charInsert(10,o,r,a)):d.a.sheetCellEditingConfirm(o,r),!0):(d.a.charInsert(10,o,r,a),!0);if(n===l.a.Tab)return d.a.charInsert(n,o,r,a),!0;if(n===l.a.Escape){if(h.a.isTableDrawing())return d.a.setTableDrawOff(),!0;var c=Object(T.d)(j.d).selectPentType;return Object(j.c)(c)&&Object(T.c)(Object(j.h)()),d.a.charInsert(n,o,r,a),!0}return!1}},3404:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var o=n(8),r=n(185),a=n(27),c=n(5),u=n(6),i=n(17),s=n(60),l=n(7),f=n.n(l),v=n(15),d=n(3692),p=n(3249),h=n(33),O=n(117);function b(e){var t=e.type,n=Object(a.a)(e.range,2),o=n[0],l=n[1],d=e.current,p=d.position,O=d.size,b=Object(r.a)(e,["type","range","current"]),M=Object(u.useRef)(null),g=Object(u.useRef)(null),D=Object(i.c)(h.f).viewMode,y=Object(u.useState)(0),j=Object(a.a)(y,2),T=j[0],S=j[1],C="vertical"===t,E=Object(u.useMemo)((function(){return l-o}),[o,l]),I=Object(u.useMemo)((function(){return E>O&&T>0}),[E,O,T]);Object(u.useEffect)((function(){var e=M.current;if(e){var t=new s.a((function(){var t=e.getBoundingClientRect(),n=t.width,o=t.height;S((C?o:n)/E)}));return t.observe(e),function(){t.unobserve(e)}}}),[C,E]);var _=Object(u.useCallback)((function(e){var t,n=null===(t=g.current)||void 0===t?void 0:t.getRect();if(n){var o=C?n.top:n.left,r=C?n.bottom:n.right,a=C?e.clientY:e.clientX;a<o?b.onScrollClick&&b.onScrollClick(!1):a>r&&b.onScrollClick&&b.onScrollClick(!0)}}),[C,b]),A={visibility:D===v.n.presentation?"hidden":"visible"};return Object(c.jsx)("div",{className:"".concat(f.a.scrollbar," ").concat(f.a[t]),ref:M,style:A,onMouseDown:_,children:I&&Object(c.jsx)(m,{ref:g,type:t,range:[o,l],current:{position:p,size:O},ratio:T,onScrollDrag:b.onScrollDrag,onScrollDrop:b.onScrollDrop})})}var m=Object(u.forwardRef)((function(e,t){var n=e.type,s=Object(a.a)(e.range,2),l=s[0],v=s[1],h=e.current,b=h.position,m=h.size,M=e.ratio,g=Object(r.a)(e,["type","range","current","ratio"]),D=Object(i.b)(),y="vertical"===n,j=Object(u.useRef)(null),T=Object(u.useState)(!1),S=Object(a.a)(T,2),C=S[0],E=S[1],I=Object(u.useRef)();Object(u.useEffect)((function(){D(C?Object(O.a)(f.a.scrollbar_drag):Object(O.c)(f.a.scrollbar_drag))}),[D,C]),Object(u.useImperativeHandle)(t,(function(){return{getRect:function(){return j.current&&j.current.getBoundingClientRect()}}}));var _=Object(u.useMemo)((function(){return C&&I.current?I.current.ratio:M}),[C,M]),A=Object(u.useMemo)((function(){return m*_}),[m,_]),L=Object(u.useMemo)((function(){return(b-l)*_}),[b,l,_]),w=Object(u.useCallback)((function(e){var t=j.current,n=null===t||void 0===t?void 0:t.parentElement;if(t&&n){var o=n.getBoundingClientRect()[y?"top":"left"],r=t.getBoundingClientRect()[y?"top":"left"];I.current={parentStart:o,innerPos:e-r,range:[l,v],size:m,ratio:M}}}),[y,m,M,l,v]),R=Object(u.useCallback)((function(e){var t=I.current;if(t){var n=e-t.parentStart,o=(n-t.innerPos)/t.ratio;o+=t.range[0],o=Math.max(o,t.range[0]),o=Math.min(o,t.range[1]-t.size);var r=n/t.ratio;return r+=t.range[0],r=Math.max(r,t.range[0]),[o,r=Math.min(r,t.range[1])]}}),[]),k=Object(u.useMemo)((function(){return{onMouseDown:function(e){var t=y?e.clientY:e.clientX;w(t)},onMouseDrag:function(e){if(!C&&E(!0),g.onScrollDrag){var t=Math.sign(e.movementY)>0,n=R(y?e.clientY:e.clientX);n&&g.onScrollDrag(n[0],n[1],t)}},onMouseDrop:function(e){if(C&&E(!1),g.onScrollDrop){var t=Math.sign(e.movementY)>0,n=R(y?e.clientY:e.clientX);n&&g.onScrollDrop(n[0],n[1],t)}I.current=void 0},onMouseUp:function(){I.current=void 0}}}),[y,C,w,R,g]),N=Object(p.c)(k),K=Object(a.a)(N,2)[1],P=Object(u.useMemo)((function(){return{onTouchStart:function(e){var t=y?e.touches[0].clientY:e.touches[0].clientX;w(t)},onTouchMove:function(e,t){var n=t.touchStatus,o=t.lastTouchList;if(n===d.a.Move&&e.touches&&o){var r=e.touches[0].clientY-o[0].clientY;if(g.onScrollDrag){var a=Math.sign(r)>0,c=R(y?e.touches[0].clientY:e.touches[0].clientX);c&&g.onScrollDrag(c[0],c[1],a)}}},onTouchEnd:function(){I.current=void 0}}}),[R,y,g,w]),V=Object(d.b)(P),Y={};Y[y?"height":"width"]="".concat(A,"px"),Y[y?"top":"left"]="".concat(L,"px");var X=f.a.bar;return C&&(X="".concat(X," ").concat(f.a.on)),Object(c.jsx)("div",Object(o.a)(Object(o.a)({className:X,ref:j,style:Y},K),V))}))},3405:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(19),r=n(20),a=n(194),c=function(){function e(){Object(o.a)(this,e),this.keyItems=void 0,this.isMacOS="macOS"===Object(a.getParser)(window.navigator.userAgent).getOSName(),this.keyItems=[],this.initKeyItem()}return Object(r.a)(e,[{key:"addItem",value:function(e,t,n,o,r,a,c){var u=t&&this.isMacOS;this.keyItems.push({keyCode:e,ctrlKey:t,shiftKey:n,altKey:o,metaKey:u,action:r,resourceID:a,combindKeyCode:c})}},{key:"getHotKeyItem",value:function(e,t){var n=this;return this.keyItems.find((function(o){var r=o.keyCode,a=o.ctrlKey,c=o.shiftKey,u=o.altKey,i=o.metaKey,s=o.combindKeyCode;return s&&t?s===(null===e||void 0===e?void 0:e.keyCode)&&r===(null===t||void 0===t?void 0:t.keyCode)&&c===t.shiftKey&&u===t.altKey&&(n.isMacOS?i===t.metaKey:a===t.ctrlKey):(r===e.keyCode||r===e.code)&&c===e.shiftKey&&u===e.altKey&&(n.isMacOS?i===e.metaKey:a===e.ctrlKey)}))}}]),e}()},3406:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(19),r=n(20),a=n(10),c=n(33),u=n(15),i=n(55),s=function(){function e(){Object(o.a)(this,e),this.previousIputKeyData=void 0}return Object(r.a)(e,[{key:"isEditMode",value:function(){return Object(a.d)(c.f).viewMode===u.n.edit}},{key:"preventInput",value:function(){i.a.blur("DocInputField"),setTimeout((function(){i.a.focus("DocInputField")}),100)}}]),e}()},3692:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var o,r=n(27),a=n(6),c=n(11);!function(e){e[e.Start=0]="Start",e[e.Move=1]="Move",e[e.End=2]="End",e[e.ScaleStart=3]="ScaleStart",e[e.Scaling=4]="Scaling",e[e.ScaleEnd=5]="ScaleEnd"}(o||(o={}));var u=function(e){var t=Object(a.useRef)(),n=Object(a.useRef)({}),u=Object(a.useState)(void 0),i=Object(r.a)(u,2),s=i[0],l=i[1],f=Object(a.useState)(void 0),v=Object(r.a)(f,2),d=v[0],p=v[1],h=Object(a.useState)(void 0),O=Object(r.a)(h,2),b=O[0],m=O[1],M=Object(a.useRef)(null);return Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useMemo)((function(){return{onTouchStart:function(n){var r=n.touches.length;if(t.current=2===r?o.ScaleStart:o.Start,t.current===o.ScaleStart){var a=c.a.getConfig();m({startZoomRatio:a.nZoomRatio,minZoomRatio:a.nMinZoom,maxZoomRatio:a.nMaxZoom})}e.onTouchStart&&e.onTouchStart(n,{touchStatus:t.current,firstTouchList:s,lastTouchList:d,zoomRatio:b}),l(n.touches),p(n.touches),M.current=setTimeout((function(){e.onLongTouch&&(e.onLongTouch(n,{touchStatus:t.current,firstTouchList:s,lastTouchList:d,zoomRatio:b}),M.current=null)}),500)},onTouchMove:function(n){t.current===o.Start?M.current&&(t.current=o.Move,clearTimeout(M.current)):t.current===o.ScaleStart&&(t.current=o.Scaling),e.onTouchMove&&e.onTouchMove(n,{touchStatus:t.current,firstTouchList:s,lastTouchList:d,zoomRatio:b}),p(n.touches)},onTouchEnd:function(n){t.current===o.Start?(M.current&&clearTimeout(M.current),t.current=o.End):t.current===o.Move?t.current=o.End:t.current===o.Scaling&&(t.current=o.ScaleEnd),e.onTouchEnd&&e.onTouchEnd(n,{touchStatus:t.current,firstTouchList:s,lastTouchList:d,zoomRatio:b}),p(n.touches)}}}),[s,e,d,b])}},3693:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var o,r=n(6);!function(e){e[e.Start=0]="Start",e[e.Update=1]="Update",e[e.End=2]="End"}(o||(o={}));var a=o.End,c=function(){return a},u=function(e){var t=Object(r.useRef)(),n=Object(r.useMemo)((function(){return{onCompositionStart:function(n){a=o.Start,t.current=!0,(null===e||void 0===e?void 0:e.onCompositionStart)&&e.onCompositionStart(n,{isComposing:t.current})},onCompositionUpdate:function(n){a=o.Update,t.current=!0,(null===e||void 0===e?void 0:e.onCompositionUpdate)&&e.onCompositionUpdate(n,{isComposing:t.current})},onCompositionEnd:function(n){a=o.End,t.current=!1,(null===e||void 0===e?void 0:e.onCompositionEnd)&&e.onCompositionEnd(n,{isComposing:t.current})}}}),[e]);return[t,n]}},3777:function(e,t,n){!function(e,t){function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var o="Left",r="Right",a="Up",c="Down",u={delta:10,preventDefaultTouchmoveEvent:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0},i={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},s="mousemove",l="mouseup",f="touchend",v="touchmove",d="touchstart";function p(e,t,n,u){return e>t?n>0?r:o:u>0?c:a}function h(e,t){if(0===t)return e;var n=Math.PI/180*t;return[e[0]*Math.cos(n)+e[1]*Math.sin(n),e[1]*Math.cos(n)-e[0]*Math.sin(n)]}function O(e,t){var o=function(t){t&&"touches"in t&&t.touches.length>1||e((function(e,o){o.trackMouse&&(document.addEventListener(s,r),document.addEventListener(l,u));var a="touches"in t?t.touches[0]:t,c=h([a.clientX,a.clientY],o.rotationAngle);return n({},e,i,{initial:[].concat(c),xy:c,start:t.timeStamp||0})}))},r=function(t){e((function(e,o){if("touches"in t&&t.touches.length>1)return e;var r="touches"in t?t.touches[0]:t,a=h([r.clientX,r.clientY],o.rotationAngle),c=a[0],u=a[1],i=c-e.xy[0],s=u-e.xy[1],l=Math.abs(i),f=Math.abs(s),v=(t.timeStamp||0)-e.start,d=Math.sqrt(l*l+f*f)/(v||1),O=[i/(v||1),s/(v||1)];if(l<o.delta&&f<o.delta&&!e.swiping)return e;var b=p(l,f,i,s),m={absX:l,absY:f,deltaX:i,deltaY:s,dir:b,event:t,first:e.first,initial:e.initial,velocity:d,vxvy:O};m.first&&o.onSwipeStart&&o.onSwipeStart(m),o.onSwiping&&o.onSwiping(m);var M=!1;return(o.onSwiping||o.onSwiped||"onSwiped"+b in o)&&(M=!0),M&&o.preventDefaultTouchmoveEvent&&o.trackTouch&&t.cancelable&&t.preventDefault(),n({},e,{first:!1,eventData:m,swiping:!0})}))},a=function(t){e((function(e,o){var r;if(e.swiping&&e.eventData){r=n({},e.eventData,{event:t}),o.onSwiped&&o.onSwiped(r);var a="onSwiped"+r.dir;a in o&&o[a](r)}else o.onTap&&o.onTap({event:t});return n({},e,i,{eventData:r})}))},c=function(){document.removeEventListener(s,r),document.removeEventListener(l,u)},u=function(e){c(),a(e)},O=function(e,t){var n=function(){};if(e&&e.addEventListener){var c=[[d,o],[v,r],[f,a]];c.forEach((function(n){var o=n[0],r=n[1];return e.addEventListener(o,r,{passive:t})})),n=function(){return c.forEach((function(t){var n=t[0],o=t[1];return e.removeEventListener(n,o)}))}}return n},b={ref:function(t){null!==t&&e((function(e,o){if(e.el===t)return e;var r={};return e.el&&e.el!==t&&e.cleanUpTouch&&(e.cleanUpTouch(),r.cleanUpTouch=void 0),o.trackTouch&&t&&(r.cleanUpTouch=O(t,!o.preventDefaultTouchmoveEvent)),n({},e,{el:t},r)}))}};return t.trackMouse&&(b.onMouseDown=o),[b,O]}function b(e,t,o){var r={};return!t.trackTouch&&e.cleanUpTouch?(e.cleanUpTouch(),r.cleanUpTouch=void 0):t.trackTouch&&!e.cleanUpTouch&&e.el&&(r.cleanUpTouch=o(e.el,!t.preventDefaultTouchmoveEvent)),n({},e,r)}function m(e){var o=e.trackMouse,r=t.useRef(n({},i)),a=t.useRef(n({},u));a.current=n({},u,e);var c=t.useMemo((function(){return O((function(e){return r.current=e(r.current,a.current)}),{trackMouse:o})}),[o]),s=c[0],l=c[1];return r.current=b(r.current,a.current,l),s}e.DOWN=c,e.LEFT=o,e.RIGHT=r,e.UP=a,e.useSwipeable=m}(t,n(6))}}]);