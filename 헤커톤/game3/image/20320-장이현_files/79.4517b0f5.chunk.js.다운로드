(this["webpackJsonppolaris-weboffice"]=this["webpackJsonppolaris-weboffice"]||[]).push([[79],{3248:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return _}));var a,i=n(19),r=n(20),o=n(10),c=n(182),l=n(33),u=n(15),s=n(34),d=n(39),p=n(55),f=n(11),T=n(0),O=n(12),b=n(24);!function(e){e[e.NATIVE_CLIPBOARD=0]="NATIVE_CLIPBOARD",e[e.EXTERNAL_CLIPBOARD=1]="EXTERNAL_CLIPBOARD"}(a||(a={}));var h=/<!--\[if gte vml 1\]>/g,C=/<!\[endif\]-->/g,E=/<!--\[PO\]\[if gte vml 1\]>/g,m=/<!\[endif\]\[PO\]-->/g,_=function(){function e(){Object(i.a)(this,e),this.clipboardDataTransfer=null,this.nativeCopyIdAttrName="nativecopyid",this.nativeCopyIdValue="",this.isNativeMode=!1,this.isCopyFormatMode=!1}return Object(r.a)(e,[{key:"setNativeMode",value:function(e){return this.isNativeMode!==e&&(this.isNativeMode=e,Object(o.c)(Object(c.c)(e)),this.isNativeMode||(this.nativeCopyIdValue=""),!0)}},{key:"getNavtiveMode",value:function(){return this.isNativeMode}},{key:"setCopyFormatMode",value:function(e){return this.isCopyFormatMode!==e&&(this.isCopyFormatMode=e,Object(o.c)(Object(c.b)(this.isCopyFormatMode)),!0)}},{key:"getCopyFormatMode",value:function(){return this.isCopyFormatMode}},{key:"showAlert",value:function(e,t){e===d.a.COMMON_CLIPBOARD?s.a.showDialog({dialogId:e,bModal:!0,currentTabIndex:0}):s.a.showDialog({dialogId:e,bModal:!0,alertMsg:{label:t},currentTabIndex:0})}},{key:"canEdit",value:function(){return Object(o.d)(l.f).viewMode===u.n.edit}},{key:"copy",value:function(e){this.clipboardDataTransfer=e,f.a.editDocument(T.BrEditMode.BR_EDITMODE_COPY,T.ClipDataType.CLIPDATA_FAVORITE_DATA,null,a.NATIVE_CLIPBOARD)}},{key:"cut",value:function(e){this.canEdit()&&(this.clipboardDataTransfer=e,f.a.editDocument(T.BrEditMode.BR_EDITMODE_CUT,T.ClipDataType.CLIPDATA_STR,null,a.NATIVE_CLIPBOARD))}},{key:"nativePaste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.BrEditMode.BR_EDITMODE_PASTE,t=b.a.get("preventPasteFromExternal");this.isNativeMode||t?f.a.editDocument(e,T.ClipDataType.CLIPDATA_STR,null,a.NATIVE_CLIPBOARD):this.showAlert(d.a.COMMON_CLIPBOARD,"")}},{key:"externalPaste",value:function(e,t){f.a.editDocument(T.BrEditMode.BR_EDITMODE_ORIGINAL_FORMAT,t,t===T.ClipDataType.CLIPDATA_HTML?this.excludeImgElements(e):e,a.EXTERNAL_CLIPBOARD),this.setNativeMode(!1)}},{key:"appendClipboardImage",value:function(e){for(var t=0;t<e.length;t+=1){var n=e[0];n&&function(){var e=new FileReader;e.onload=function(){if(e.readyState===FileReader.DONE&&e.result instanceof ArrayBuffer){var t=e.result;f.a.imageInsert(t,0,0,0,0,0)}},e.readAsArrayBuffer(n)}()}}},{key:"clipboardPaste",value:function(e){if(this.canEdit()){var t=e.getData&&e.getData("text/plain"),n=e.getData&&e.getData("text/html"),a=!Object(O.isEmpty)(n),i=!Object(O.isEmpty)(t),r=a&&n.includes("".concat(this.nativeCopyIdAttrName,'="').concat(this.nativeCopyIdValue,'"')),o=e.files&&e.files.length>0,c=b.a.get("preventPasteFromExternal");r||c?this.nativePaste():o&&!i?this.appendClipboardImage(e.files):a&&this.htmlDataTagCount(n)>0?this.externalPaste(n,T.ClipDataType.CLIPDATA_HTML):i&&this.externalPaste(t,T.ClipDataType.CLIPDATA_STR)}}},{key:"htmlDataTagCount",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",n=document.createElement("div");n.innerHTML=e;var a=n.getElementsByTagName(t).length;return n.remove(),a}},{key:"createClipboardElement",value:function(e){var t=document.createElement("div");return t.innerHTML=this.excludeVML(e),document.body.appendChild(t),t.children[0]&&(this.nativeCopyIdValue="".concat(Math.floor(1e5*Math.random())+1),t.children[0].setAttribute(this.nativeCopyIdAttrName,this.nativeCopyIdValue)),t}},{key:"copyToClipboard",value:function(e,t){var n=null;if(t===T.ClipDataType.CLIPDATA_STR)(n=document.createElement("textarea")).value=e,document.body.appendChild(n),n.select(),document.execCommand("copy");else{n=this.createClipboardElement(e);var a=document.createRange();a.selectNodeContents(n);var i=window.getSelection();if(i){var r,o,c=[];if(i.rangeCount>0)for(var l=0;l<i.rangeCount;l+=1){var u=i.getRangeAt(l);c.push(u)}if(i.removeAllRanges(),i.addRange(a),document.execCommand("copy"),i.removeAllRanges(),c&&c.length>0)for(var s=0;s<c.length;s+=1)i.addRange(c[s]);var d=null===(r=p.a.getForcusRef("DocInputField"))||void 0===r||null===(o=r.elementRef)||void 0===o?void 0:o.current;d&&d instanceof HTMLInputElement&&d.select()}}n.remove(),p.a.focus("DocInputField")}},{key:"isDuplicatedShape",value:function(e){var t=document.createElement("div");t.innerHTML=e.replace(h,"").replace(C,"");for(var n=t.getElementsByTagName("img"),a=0;a<n.length;a+=1){var i=n[a].getAttribute("v:shapes");if(!Object(O.isEmpty)(i)){var r=t.querySelector('[id="'.concat(i,'"]'));if(!r||!r.tagName||!r.tagName.toLowerCase().startsWith("v:"))return!1}}return!0}},{key:"excludeVML",value:function(e){if(!this.isDuplicatedShape(e))return e;var t=e;return t=(t=t.replace(h,"\x3c!--[PO][if gte vml 1]>")).replace(C,"<![endif][PO]--\x3e")}},{key:"excludeImgElements",value:function(e){if(!E.test(e)||!m.test(e))return e;var t=document.createElement("div");t.innerHTML=e.replace(E,"").replace(m,"");var n=document.createElement("div");n.innerHTML=e.replace(E,"\x3c!--[if gte vml 1]>").replace(m,"<![endif]--\x3e");for(var a=n.getElementsByTagName("img"),i=a.length-1;i>=0;i-=1){var r=a[i],o=r.getAttribute("v:shapes");if(!Object(O.isEmpty)(o)){var c=t.querySelector('[id="'.concat(o,'"]'));c&&c.tagName&&c.tagName.toLowerCase().startsWith("v:")&&r.remove()}}return n.innerHTML}}]),e}()},3284:function(e,t,n){"use strict";n.d(t,"d",(function(){return T})),n.d(t,"e",(function(){return O})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return h})),n.d(t,"f",(function(){return C}));var a=n(25),i=n(28),r=n(26),o=n(21),c=n(0),l=n(11),u=n(10),s=n(67),d={isFindDisabled:!1,isReplaceDisabled:!1,findString:"",replaceString:"",direction:void 0,eFindReplaceResultType:void 0,highlightedCount:void 0},p=Object(a.c)({name:"findReplace",initialState:d,reducers:{setFindString:function(e,t){e.findString=t.payload},setReplaceString:function(e,t){e.replaceString=t.payload},setHighlightedCount:function(e,t){e.highlightedCount=t.payload},setDirection:function(e,t){e.direction=t.payload}},extraReducers:function(e){e.addCase(r.h,(function(e){e.isFindDisabled=s.a.isDisable(o.N),e.isReplaceDisabled=s.a.isDisable(o.O)})),e.addCase(r.A,(function(e,t){e.eFindReplaceResultType=t.payload.nResult}))}}),f=p.actions,T=f.setFindString,O=(f.setReplaceString,f.setHighlightedCount),b=f.setDirection;t.a=p.reducer;var h=Object(i.a)((function(e){return e.command.edit.findReplace}),(function(e){return e})),C=(Object(i.a)(h,(function(e){return{isDisabled:e.isFindDisabled}})),Object(i.a)(h,(function(e){return{isDisabled:e.isReplaceDisabled}})),function(e){return Object(u.b)("startFindRepeatInvertThunk",(function(t,n){var a=n().command.edit.findReplace.direction===c.BrFindReplaceDirectionType.BR_FIND_DIR_NEXT||n().command.edit.findReplace.direction===c.BrFindReplaceDirectionType.BR_FIND_DIR_GLOBAL?c.BrFindReplaceDirectionType.BR_FIND_DIR_PREV:c.BrFindReplaceDirectionType.BR_FIND_DIR_NEXT;e.Direction=a,l.a.searchStart(e),t(b(a))}))})},3285:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d}));var a=n(8),i=n(47),r=n(25),o=n(28),c=Object(r.c)({name:"activeLink",initialState:{isLogin:!1,infos:[]},reducers:{setActiveLinkLogin:function(e,t){e.isLogin=t.payload},setActiveLinkInfo:function(e,t){var n=new Set(t.payload.map((function(e){return e.frameId}))),r=[].concat(Object(i.a)(t.payload),Object(i.a)(e.infos.filter((function(e){return!n.has(e.frameId)})).map((function(e){return Object(a.a)(Object(a.a)({},e),{},{originalRect:{left:0,top:0,right:0,bottom:0}})})))).sort((function(e,t){return e.frameId<t.frameId?1:e.frameId>t.frameId?-1:0}));e.infos=r}}}),l=c.actions,u=l.setActiveLinkLogin,s=l.setActiveLinkInfo;t.a=c.reducer;var d=Object(o.a)((function(e){return e.activeLink}),(function(e){return e}))},3288:function(e,t,n){"use strict";n.d(t,"d",(function(){return O})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return h})),n.d(t,"e",(function(){return C}));var a=n(25),i=n(28),r=n(10),o=n(26),c=n(67),l=n(21),u=n(3308),s=n(11),d=n(43),p={isDisabled:!1,currentStyleIndex:-1,thumbnailDatas:[]},f=Object(a.c)({name:"fontStyle",initialState:p,reducers:{setFontStyleThumbnail:function(e,t){var n=t.payload.thumbnailDatas;e.thumbnailDatas=n},clearFontStyleDatas:function(){return p}},extraReducers:function(e){e.addCase(o.h,(function(e){e.isDisabled=c.a.isDisable(l.eb)})),e.addCase(d.g,(function(e,t){"home_style"===t.payload.id&&(e.currentStyleIndex=s.a.getStyleTypeIndex())}))}}),T=f.actions,O=T.setFontStyleThumbnail,b=T.clearFontStyleDatas;t.b=f.reducer;var h=Object(i.a)((function(e){return e.command.font}),(function(e){return e.style})),C=function(){return Object(r.b)("setFontStyleThumbnailThunk",(function(e){u.a.requestThumbnail()}))}},3299:function(e,t,n){"use strict";var a=n(19),i=n(20),r=n(30),o=n(29),c=n(3248),l=n(13),u=n(0),s=n(3),d=n(24),p=function(e){Object(r.a)(n,e);var t=Object(o.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"onClipboardResult",value:function(e,t,n,a){if(e===u.ClipBoardEventType.COPY_EVENT||e===u.ClipBoardEventType.CUT_EVENT){if(this.setNativeMode(!0),d.a.get("preventCopyToExternal"))return;var i="",r=u.ClipDataType.CLIPDATA_STR;if(""!==n&&(i=n),""!==a&&(i=a,r=u.ClipDataType.CLIPDATA_HTML),l.a.getObjectControlType()!==s.EPBOCtrType.eObjCtrTemplate&&l.a.getObjectControlType()!==s.EPBOCtrType.eObjCtrTemplateInlineText&&l.a.getObjectControlType()!==s.EPBOCtrType.eObjCtrLine&&l.a.getObjectControlType()!==s.EPBOCtrType.eObjCtrLineInlineText&&l.a.getObjectControlType()!==s.EPBOCtrType.eObjCtrImage&&l.a.getObjectControlType()!==s.EPBOCtrType.eObjCtrImageInlineText&&l.a.getObjectControlType()!==s.EPBOCtrType.eObjCtrChart&&l.a.getObjectControlType()!==s.EPBOCtrType.eObjCtrChartInlineText||(i="<span>".concat(i,"</span>"),r=u.ClipDataType.CLIPDATA_HTML),this.clipboardDataTransfer){var o=this.createClipboardElement(i);this.clipboardDataTransfer.setData("text/html",o.innerHTML),n.length>0&&this.clipboardDataTransfer.setData("text/plain",n),this.clipboardDataTransfer=null,o.remove()}else this.copyToClipboard(i,r)}}}]),n}(c.a);t.a=new p},3300:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return f}));var a=n(25),i=n(28),r=n(11),o=n(26),c=n(52),l=n(10),u=Object(a.c)({name:"showMemo",initialState:{isDisabled:!1,isChecked:!1},reducers:{},extraReducers:function(e){e.addCase(o.h,(function(e){e.isChecked=r.a.memoIsShow()}))}}),s=Object(i.a)((function(e){return e.command.view.showMemo}),(function(e){return e}));t.a=u.reducer;var d=function(e){r.a.memoSetShow(e)},p=function(){return Object(l.b)("initShowMemoThunk",(function(e){var t="true"===Object(c.b)(c.a.HWP_SHOW_MEMO);d(t)}))},f=function(e){return Object(l.b)("setShowMemoThunk",(function(t){var n;d(e),n=e,Object(c.c)(c.a.HWP_SHOW_MEMO,n?"true":"false")}))}},3308:function(e,t,n){"use strict";var a=n(19),i=n(20),r=n(11),o=n(10),c=n(3288),l=function(){function e(){Object(a.a)(this,e),this._thumbnailDatas=[],this._thumbnailCount=0,this.HWP_STYLE_COUNT=32,this.HWP_STYLE_NAME_LIST=["QUICK_STYLE_NORMAL","QUICK_STYLE_NOSPACE","QUICK_STYLE_TITLE","QUICK_STYLE_HEADING1","QUICK_STYLE_HEADING2","QUICK_STYLE_HEADING3","QUICK_STYLE_HEADING4","QUICK_STYLE_HEADING5","QUICK_STYLE_HEADING6","QUICK_STYLE_HEADING7","QUICK_STYLE_HEADING8","QUICK_STYLE_HEADING9","QUICK_STYLE_SUBTITLE","QUICK_STYLE_SUBEMPHASI","QUICK_STYLE_EMPHASIS","QUICK_STYLE_INTEMPHASI","QUICK_STYLE_STRONG","QUICK_STYLE_QUOTE","QUICK_STYLE_INTQUOTE","QUICK_STYLE_SUBREFER","QUICK_STYLE_INTREFER","QUICK_STYLE_BOOKTITLE","QUICK_STYLE_LISTPARA"]}return Object(i.a)(e,[{key:"requestThumbnail",value:function(){this._thumbnailDatas=[],this._thumbnailCount=0,r.a.getPreviewStyle(66,30,0)}},{key:"OnDrawGetPreviewStyle",value:function(e,t,n,a,i,r,l){if(this.HWP_STYLE_NAME_LIST.length>i){var u={index:i,width:t,height:n,url:e,styleName:this.HWP_STYLE_NAME_LIST[i],styleIndex:a};this._thumbnailCount+=1,this._thumbnailDatas[i]=u,this._thumbnailCount>=this.HWP_STYLE_NAME_LIST.length&&Object(o.c)(Object(c.d)({thumbnailDatas:this._thumbnailDatas}))}}}]),e}();t.a=new l},3356:function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return O})),n.d(t,"d",(function(){return b}));var a=n(25),i=n(28),r=n(10),o=n(11),c=n(26),l=n(67),u=n(21),s=n(52),d=Object(a.c)({name:"gridline",initialState:{isChecked:!0,isDisabled:!1},reducers:{setIsChecked:function(e,t){e.isChecked=t.payload}},extraReducers:function(e){e.addCase(c.h,(function(e){e.isChecked=o.a.getGridGuides().bShow,e.isDisabled=l.a.isDisable(u.sc)}))}}),p=function(e){var t=o.a.getGridGuides();o.a.setGridGuides(e,t.bSnap,t.nGapHimetric)},f=Object(i.a)((function(e){return e.command.view.gridline}),(function(e){return e})),T=d.actions.setIsChecked;t.a=d.reducer;var O=function(){return Object(r.b)("initGridlineThunk",(function(e){var t="true"===Object(s.b)(s.a.HWP_GRIDLINE_SHOW_KEY);p(t),e(T(t))}))},b=function(e){return Object(r.b)("setGridlineThunk",(function(t){p(e),t(T(e)),function(e){Object(s.c)(s.a.HWP_GRIDLINE_SHOW_KEY,e?"true":"false")}(e)}))}},515:function(e,t,n){"use strict";n.r(t);var a=n(10),i=n(51),r=n(43),o=n(56),c=n(183),l=n(11),u=n(181),s=n(3299),d=n(3308),p=n(3356),f=n(0),T=n(34),O=n(39),b=n(102),h=n(14),C=n(3284),E=n(3300),m=n(24),_=n(3285),I={OnInitComplete:function(){Object(h.o)()||Object(a.c)(Object(p.b)())},OnOpenComplete:function(){i.b.commandInitvalue(),o.a.hideContextMenu(),Object(a.c)(Object(r.b)()),Object(a.c)(Object(c.e)()),l.a.setZoom(1e4),l.a.scrollUp(f.EScrollFactorType.eSCROLL_FACTOR_80),h.j&&l.a.setViewMode(f.EVIEWMODE_TYPE.eVIEWMODE_FITTOWIDTH),setTimeout((function(){Object(a.c)(Object(E.b)())}),200)},OnLoadFail:function(e){switch(b.a.apply("onLoadFail",[e]),e){case f.ResultOnLoadFail.kPoErrUnsupportedVersion:T.a.showDialog({dialogId:O.a.COMMON_NO_CLOSE_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_NOT_SUPPORT_VERSION"}},(function(){b.a.apply("onCancelOpenDocument")}));break;case f.ResultOnLoadFail.kPoErrUnsupportedEncryptionType:case f.ResultOnLoadFail.kPoErrUnsupportedVersionHwpxPassword:b.a.apply("onLoadFail",[e]),T.a.showDialog({dialogId:O.a.COMMON_NO_CLOSE_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_OPEN_ENCRYPTION_TYPE"}},(function(){b.a.apply("onCancelOpenDocument")}));break;case f.ResultOnLoadFail.kPoErrUnsupportedVersionHwpxDistribution:b.a.apply("onLoadFail",[e]),T.a.showDialog({dialogId:O.a.COMMON_NO_CLOSE_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_OPEN_DISTRIBUTION_HWPX"}},(function(){b.a.apply("onCancelOpenDocument")}));break;default:T.a.showDialog({dialogId:O.a.COMMON_NO_CLOSE_ALERT,bModal:!0,alertMsg:{label:"IDS_MSG_ERROR_OPEN_INTERNAL"}},(function(){b.a.apply("onCancelOpenDocument")}))}},OnDrawBitmapThrottle:function(){Object(a.c)(Object(c.n)())},OnShapeDrawModeEnd:function(){u.a.endShapeDraw()},OnGetHighlightListCount:function(e){Object(a.c)(Object(C.e)(e))},OnClipboardResult:function(e){var t=e.nEventType,n=e.nResult,a=e.textData,i=e.htmlData;s.a.onClipboardResult(t,n,a,i)},OnDrawGetPreviewStyle:function(e){var t=e.imageBlob,n=e.width,a=e.height,i=e.styleIndex,r=e.index,o=e.styleName,c=e.bTextAttStyle;d.a.OnDrawGetPreviewStyle(URL.createObjectURL(t),n,a,i,r,o,c)},OnNewDoc:function(){},OnGetImageLocationsInScreen:function(e){var t=e.imageLocations;if(m.a.checkCallback("onServiceExternal")){var n=[];t.forEach((function(e){var t=e.priority,a=e.points,i=e.origin_rect,r=e.rotateAngle,o=e.frameID,c=e.urlExists,l=c?e.frameUrl:"";n.push({priority:t,points:a,originalRect:i,rotateAngle:r,frameId:o,frameUrl:l,existUrl:c})})),Object(a.c)(Object(_.c)(n))}}};t.default=I}}]);